<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app224.us.archive.org';v.server_ms=1716;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/_static/js/bundle-playback.js?v=KTqwAcYd" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=UHAOicsW" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://www.networksorcery.com/enp/protocol/mep.htm","20210425232301","https://web.archive.org/","web","/_static/",
	      "1619392981");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=fantwOh2" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="/web/20210425232301cs_/http://www.networksorcery.com/enp/css/page.css">
<script type="text/javascript" src="/web/20210425232301js_/http://www.networksorcery.com/enp/scriptlet/global.js">
</script>

<meta name="keywords" content="rfcsourcebook, protocol, Minimal Encapsulation Protocol">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Minimal Encapsulation Protocol</title>
</head>

<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20210425232301/http%3A//www.networksorcery.com/enp/protocol/mep.htm"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.networksorcery.com/enp/protocol/mep.htm" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20210425232301" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
		<div class="s" id="wm-nav-captures" style="flex:1;">
	  	  <a class="t" href="/web/20210425232301*/http://www.networksorcery.com/enp/protocol/mep.htm" title="See a list of every capture for this URL">111 captures</a>
	  <div class="r" title="Timespan for captures of this URL">21 Feb 2001 - 06 May 2021</div>
	  </div>
	<div class="k">
	  <a href="" id="wm-graph-anchor">
	    <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
	      <canvas id="wm-sparkline-canvas" width="675" height="27" border="0"></canvas>
	    </div>
	  </a>
	</div>
      </div>
    </div>
    <div class="n">
      <table>
	<tbody>
	  <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
	  <tr class="m">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20200808194400/http://www.networksorcery.com:80/enp/protocol/mep.htm" title="08 Aug 2020"><strong>Aug</strong></a></td>
	    <td class="c" id="displayMonthEl" title="You are here: 23:23:01 Apr 25, 2021">APR</td>
	    <td class="f" nowrap="nowrap">May</td>
	  </tr>
	  <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
	  <tr class="d">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20200808194400/http://www.networksorcery.com:80/enp/protocol/mep.htm" title="19:44:00 Aug 08, 2020"><img src="/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
	    <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 23:23:01 Apr 25, 2021">25</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210506110906/http://www.networksorcery.com/enp/protocol/mep.htm" title="11:09:06 May 06, 2021"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
	  </tr>
	  <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
	  <tr class="y">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20200220232626/http://www.networksorcery.com:80/enp/protocol/mep.htm" title="20 Feb 2020"><strong>2020</strong></a></td>
	    <td class="c" id="displayYearEl" title="You are here: 23:23:01 Apr 25, 2021">2021</td>
	    <td class="f" nowrap="nowrap">2022</td>
	  </tr>
	</tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
        	<span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#"
	     title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
	</span>
        	<a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20210425232301/http://web.archive.org/screenshot/http://www.networksorcery.com/enp/protocol/mep.htm"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
	<a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20210425232301/http://www.networksorcery.com/enp/protocol/mep.htm" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20210425232301/http://www.networksorcery.com/enp/protocol/mep.htm" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
	<a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
                    <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/open-syllabus)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/open-syllabus" target="_new"><span class="wm-title">Open Syllabus</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  <div>The Open Syllabus collection contains WARC files from a mid-2021 crawl of about 50 million unique seed URLs extracted from the Open Syllabus version 2.6 dataset and their page requisites. The bulk of the seed URLs are from ".com", ".org", ".edu", and ".uk" TLDs.</div><div><br></div><div><b>Crawl Summary</b></div><div><ul><li>Crawl start: 2021-04-12</li><li>Crawl end: 2021-09-05</li><li>Seed URLs: 49,735,419</li><li>Archived URLs: 338,690,414</li><li>Collection Size: 25 TB</li><li>Crawler: Heritrix/3.3.0-hq1-SNAPSHOT-2015-03-16T18:09:23Z</li><li>Crawl depth: maxHops=0</li></ul></div><div><br></div><div><b>Seed Summary</b></div><div><ul><li>Unique URLs: 49,735,419</li><li>Unique Canonical URLs: 48,956,395</li><li>Unique Hosts: 984,223</li><li>IPv4 Addresses: 3,328</li><li>Unique TLDs: 21,761</li><li>Unique IANA Valid TLDs: 739</li><li>Wayback Machine URLs*: 6,568,213</li></ul></div><div>* NOTE: More than 13% URLs in the dataset point to Wayback Machine!<br></div><div><br></div>
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20210425232301/http://www.networksorcery.com/enp/protocol/mep.htm</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(675,27,25,2,"web","http://www.networksorcery.com/enp/protocol/mep.htm","20210425232301",1996,"/_static/",["/_static/css/banner-styles.css?v=fantwOh2","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->

<table cellspacing="0" cellpadding="4" width="100%" border="2">
<tr>
<td class="pagetitle">Minimal Encapsulation Protocol</td></tr>
</table>

<hr>

<table border="0" width="100%" bgcolor="white">
<tr>
<td><a href="#Description">Description</a></td>
<td><a href="#Glossary">Glossary</a></td>
<td><a href="#RFCs">RFCs</a></td>
<td><a href="#Publications">Publications</a></td>
<td><a href="#Obsolete RFCs">Obsolete RFCs</a></td></tr>
</table>

<hr>

<script type="text/javascript">ad();</script>

<p><b><a name="Description">Description</a>:</b></p>

<table>
<tr>
<td align="right"><i>Protocol suite:</i></td><td>
<a href="/web/20210425232301/http://www.networksorcery.com/enp/topic/ipsuite.htm">TCP/IP</a>.</td></tr>
<tr>
<td align="right"><i>Type:</i></td><td>Transport layer protocol.</td></tr>
<tr>
<td align="right"><i>IP Protocol:</i></td><td>55.</td></tr>
</table>

<p>An IP datagram is encapsulated with an outer minimal forwarding IP header.</p>

<p>
<a href="/web/20210425232301/http://www.networksorcery.com/enp/rfc/rfc2004.txt">RFC 2004</a>:</p>
<blockquote>
<p>This document specifies a method by which an IP datagram may be encapsulated (carried
as payload) within an IP datagram, with less overhead than &quot;conventional&quot; IP
  encapsulation that adds a second IP header to each encapsulated datagram.
  Encapsulation is suggested as a means to alter the normal IP routing for datagrams, by
  delivering them to an intermediate destination that would otherwise not be selected by the
  (network part of the) IP Destination Address field in the original IP header. The process
  of encapsulation and decapsulation of a datagram is frequently referred to as
  &quot;tunneling&quot; the datagram, and the encapsulator and decapsulator are then
  considered to be the the &quot;endpoints&quot; of the tunnel; the encapsulator node is
refered to as the &quot;entry point&quot; of the tunnel, and the decapsulator node is refered to as the &quot;exit point&quot; of the tunnel.</p>

<p>The Mobile IP working group has specified the use of encapsulation as a way to deliver
packets from a mobile node's &quot;home network&quot; to an agent that can deliver
  datagrams locally by conventional means to the mobile node at its current location away
  from home. The use of encapsulation may also be indicated whenever the source
  (or an intermediate router) of an IP datagram must influence the route by which a datagram
  is to be delivered to its ultimate destination. Other possible applications of
  encapsulation include multicasting, preferential billing, choice of routes with selected
  security attributes, and general policy routing.</p>

<p>A minimal forwarding header is defined for datagrams which are not fragmented prior to
encapsulation. Use of this encapsulating method is optional. Minimal encapsulation MUST
  NOT be used when an original datagram is already fragmented, since there is no room in the
  minimal forwarding header to store fragmentation information. To encapsulate an IP
datagram using minimal encapsulation, the minimal forwarding header is inserted into the datagram.</p>
</blockquote>

<hr>

<table border="1">
<tr>
<td class="highlight">MAC header</td>
<td class="highlight"><a href="ip.htm">IP</a> header</td>
    <td class="pkthdr">Minimal encapsulation header</td>
    <td class="pktvarlen">Data :::</td></tr>
</table>

<p><b>IP header:</b><br>
The original IP header is modified as follows:</p>
<ul>
<li>The Destination Address field is replaced by the IP address of the exit point of the tunnel.</li>
<li>If the encapsulator is not the original source of the datagram, the Source
    Address field in the IP header is replaced by the IP address of the encapsulator.</li>
<li>The Total Length field is incremented by the size of the
    minimal forwarding header added to the datagram. This incremental size is
    either 12 or 8 bytes, depending on whether or not the Original Source
    Address Present (S) bit is set in the forwarding header.</li>
<li>The Header Checksum is recomputed or updated to
    account for the changes in the IP header described here for encapsulation.</li>
</ul>

<p><b>Minimal encapsulation header:</b></p>

<table border="1">
<tr>
<th>00</th><th>01</th><th>02</th><th>03</th><th>04</th><th>05</th><th>06</th><th>07</th>
<th>08</th><th>09</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th>
    <th>16</th>
    <th>17</th>
    <th>18</th>
    <th>19</th>
    <th>20</th>
    <th>21</th>
    <th>22</th>
    <th>23</th>
    <th>24</th>
    <th>25</th>
    <th>26</th>
    <th>27</th>
    <th>28</th>
    <th>29</th>
    <th>30</th>
    <th>31</th></tr>
<tr>
    <td class="pkthdr" colspan="8">Protocol</td>
    <td class="pkthdr">S</td>
    <td class="pktconst" colspan="7">reserved</td>
    <td class="pkthdr" colspan="16">Header checksum</td></tr>
  <tr>
    <td class="pkthdr" colspan="32">Destination IP address</td>
  </tr>
  <tr>
    <td class="pktvarlen" colspan="32">Original Source IP address</td>
  </tr>
<tr>
<td class="pktvarlen" colspan="32">Data :::</td></tr>
</table>

<p><b>Protocol.</b>
8 bits.<br>
Copied from the Protocol field in the original IP header.</p>

<p><b>S, Original Source Address Present.</b>
1 bit.</p>

<table class="datatbl" border="1" cellspacing="0">
<tr>
<th>S</th><th>Description</th></tr>
<tr>
<th>0</th>
<td>The Original Source Address field is not present. The length of the minimal tunneling header is 8 bytes.</td></tr>
<tr>
<th>1</th>
<td>The Original Source Address field is present. The length of the minimal tunneling header is 12 bytes.</td></tr>
</table>

<p><b>reserved.</b>
7 bits.<br>
Always cleared to 0.</p>

<p><b>Header checksum.</b>
16 bits.<br>
The 16-bit one's complement of the one's complement sum of all 16-bit words in
the minimal forwarding header. For purposes of computing the checksum, the value
of the checksum field is 0. The IP header and IP payload (after the minimal
forwarding header) are not included in this checksum computation.</p>

<b>Destination IP address.</b>
32 bits.<br>
Copied from the Destination Address field in the original IP header.

<p><b>Original Source IP address.</b>
32 bits.<br>
Copied from the Source Address field in the original IP header.
This field is present only if the <i>S</i> bit is set.</p>

<hr>

<p><b><a name="Glossary">Glossary</a>:</b></p>

<hr>

<p><b><a name="RFCs">RFCs</a>:</b></p>

<p><b>[<a href="/web/20210425232301/http://www.networksorcery.com/enp/rfc/rfc2004.txt">RFC 2004</a>]</b>
Minimal Encapsulation within IP.</p>

<hr>

<table border="0" width="100%" bgcolor="white">
<tr>
<td><a href="#Description">Description</a></td>
<td><a href="#Glossary">Glossary</a></td>
<td><a href="#RFCs">RFCs</a></td>
<td><a href="#Publications">Publications</a></td>
<td><a href="#Obsolete RFCs">Obsolete RFCs</a></td></tr>
</table>

<hr>

<script type="text/javascript">copyrightnetworksorcery();</script>
<script type="text/javascript">analytics();</script>
<script type="text/javascript">pagetracker();</script>
</body>
</html>
<!--
     FILE ARCHIVED ON 23:23:01 Apr 25, 2021 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 18:14:21 Aug 15, 2022.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 504.57
  exclusion.robots: 0.3
  exclusion.robots.policy: 0.288
  RedisCDXSource: 303.727
  esindex: 0.012
  LoadShardBlock: 176.472 (3)
  PetaboxLoader3.datanode: 1242.964 (4)
  CDXLines.iter: 15.466 (3)
  load_resource: 1205.548
  PetaboxLoader3.resolve: 112.154
-->