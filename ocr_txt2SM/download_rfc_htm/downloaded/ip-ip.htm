<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app209.us.archive.org';v.server_ms=435;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/_static/js/bundle-playback.js?v=KTqwAcYd" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=UHAOicsW" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://www.networksorcery.com/enp/protocol/ip-ip.htm","20210426065322","https://web.archive.org/","web","/_static/",
	      "1619420002");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=fantwOh2" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="/web/20210426065322cs_/http://www.networksorcery.com/enp/css/page.css">
<script type="text/javascript" src="/web/20210426065322js_/http://www.networksorcery.com/enp/scriptlet/global.js"></script>

<meta name="keywords" content="protocol, IP in IP encapsulation">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>IP in IP encapsulation</title>
</head>

<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20210426065322/http%3A//www.networksorcery.com/enp/protocol/ip-ip.htm"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.networksorcery.com/enp/protocol/ip-ip.htm" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20210426065322" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
		<div class="s" id="wm-nav-captures" style="flex:1;">
	  	  <a class="t" href="/web/20210426065322*/http://www.networksorcery.com/enp/protocol/ip-ip.htm" title="See a list of every capture for this URL">117 captures</a>
	  <div class="r" title="Timespan for captures of this URL">19 May 2000 - 30 Sep 2021</div>
	  </div>
	<div class="k">
	  <a href="" id="wm-graph-anchor">
	    <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
	      <canvas id="wm-sparkline-canvas" width="675" height="27" border="0"></canvas>
	    </div>
	  </a>
	</div>
      </div>
    </div>
    <div class="n">
      <table>
	<tbody>
	  <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
	  <tr class="m">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20200721185259/http://www.networksorcery.com:80/enp/protocol/ip-ip.htm" title="21 Jul 2020"><strong>Jul</strong></a></td>
	    <td class="c" id="displayMonthEl" title="You are here: 06:53:22 Apr 26, 2021">APR</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210930065718/http://www.networksorcery.com/enp/protocol/ip-ip.htm" title="30 Sep 2021"><strong>Sep</strong></a></td>
	  </tr>
	  <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
	  <tr class="d">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20200721185259/http://www.networksorcery.com:80/enp/protocol/ip-ip.htm" title="18:52:59 Jul 21, 2020"><img src="/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
	    <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 06:53:22 Apr 26, 2021">26</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20210505213245/http://www.networksorcery.com/enp/protocol/ip-ip.htm" title="21:32:45 May 05, 2021"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
	  </tr>
	  <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
	  <tr class="y">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20200222054614/http://www.networksorcery.com:80/enp/protocol/ip-ip.htm" title="22 Feb 2020"><strong>2020</strong></a></td>
	    <td class="c" id="displayYearEl" title="You are here: 06:53:22 Apr 26, 2021">2021</td>
	    <td class="f" nowrap="nowrap">2022</td>
	  </tr>
	</tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
        	<span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#"
	     title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
	</span>
        	<a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20210426065322/http://web.archive.org/screenshot/http://www.networksorcery.com/enp/protocol/ip-ip.htm"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
	<a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20210426065322/http://www.networksorcery.com/enp/protocol/ip-ip.htm" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20210426065322/http://www.networksorcery.com/enp/protocol/ip-ip.htm" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
	<a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
                    <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/open-syllabus)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/open-syllabus" target="_new"><span class="wm-title">Open Syllabus</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  <div>The Open Syllabus collection contains WARC files from a mid-2021 crawl of about 50 million unique seed URLs extracted from the Open Syllabus version 2.6 dataset and their page requisites. The bulk of the seed URLs are from ".com", ".org", ".edu", and ".uk" TLDs.</div><div><br></div><div><b>Crawl Summary</b></div><div><ul><li>Crawl start: 2021-04-12</li><li>Crawl end: 2021-09-05</li><li>Seed URLs: 49,735,419</li><li>Archived URLs: 338,690,414</li><li>Collection Size: 25 TB</li><li>Crawler: Heritrix/3.3.0-hq1-SNAPSHOT-2015-03-16T18:09:23Z</li><li>Crawl depth: maxHops=0</li></ul></div><div><br></div><div><b>Seed Summary</b></div><div><ul><li>Unique URLs: 49,735,419</li><li>Unique Canonical URLs: 48,956,395</li><li>Unique Hosts: 984,223</li><li>IPv4 Addresses: 3,328</li><li>Unique TLDs: 21,761</li><li>Unique IANA Valid TLDs: 739</li><li>Wayback Machine URLs*: 6,568,213</li></ul></div><div>* NOTE: More than 13% URLs in the dataset point to Wayback Machine!<br></div><div><br></div>
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20210426065322/http://www.networksorcery.com/enp/protocol/ip-ip.htm</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(675,27,25,2,"web","http://www.networksorcery.com/enp/protocol/ip-ip.htm","20210426065322",1996,"/_static/",["/_static/css/banner-styles.css?v=fantwOh2","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->

<table cellspacing="0" cellpadding="4" width="100%" border="2">
<tr>
<td class="pagetitle">IP in IP Encapsulation</td></tr>
</table>

<hr>

<table border="0" width="100%" bgcolor="white">
<tr>
<td>
<a href="https://web.archive.org/web/20210426065322/http://www.networksorcery.com/enp/" target="_parent"><img src="/web/20210426065322im_/http://www.networksorcery.com/enp/images/rfcsbutton.jpg" width="162" height="31"></a></td>
<td align="center" width="20%"><a href="#Description">Description</a></td>
<td align="center" width="20%"><a href="#Glossary">Glossary</a></td>
<td align="center" width="20%"><a href="#RFCs">RFCs</a></td>
<td align="center" width="20%"><a href="#Publications">Publications</a></td>
<td align="center" width="20%"><a href="#Obsolete RFCs">Obsolete RFCs</a></td></tr>
</table>

<hr>

<script type="text/javascript">ad();</script>

<p><b><a name="Description">Description</a>:</b></p>

<table>
<tr>
<td align="right"><i>Protocol suite:</i></td><td>
<a href="/web/20210426065322/http://www.networksorcery.com/enp/topic/ipsuite.htm">TCP/IP</a>.</td></tr>
<tr>
<td align="right"><i>
<a href="/web/20210426065322/http://www.networksorcery.com/enp/Protocol.htm">Protocol type</a>:</i></td><td>Transport layer protocol.</td></tr>
<tr>
<td align="right"><i>
<a href="ip.htm">IP</a> Protocol:</i></td><td>4.</td></tr>
<tr>
<td align="right"><i>
<a href="/web/20210426065322/http://www.networksorcery.com/enp/data/mime.htm">MIME</a> subtype:</i></td><td></td></tr>
<tr>
<td align="right"><i>
<a href="snmp.htm">SNMP</a>
<a href="snmp/mibs.htm">MIBs</a>:</i></td><td></td></tr>
<tr>
<td align="right"><i>
<a href="https://web.archive.org/web/20210426065322/http://www.ietf.org/html.charters/wg-dir.html">Working groups</a>:</i></td><td>
<a href="https://web.archive.org/web/20210426065322/http://www.ietf.org/wg/concluded/mobileip.html">mobileip</a>, IP Routing for Wireless/Mobile Hosts.</td></tr>
<tr>
<td align="right"><i>Links:</i></td><td></td></tr>
</table>

<p>This protocol provides a mechanism to encapsulate an IP header with an outer IP header for tunneling.</p>

<p>
<a href="/web/20210426065322/http://www.networksorcery.com/enp/rfc/rfc1853.txt">RFC 1853</a>:</p>
<blockquote>
<p>The encapsulation technique is fairly simple.
An outer IP header is added before the original IP header.
Between them are any other headers for the path, such as security headers specific to the tunnel configuration.</p>
  
<p>The outer IP header Source and Destination identify the &quot;endpoints&quot; of the tunnel.
The inner IP header Source and Destination identify the original sender and recipient of the datagram.</p>
  
<p>Each header chains to the next using IP Protocol values.</p>
</blockquote>

<p>
<a href="/web/20210426065322/http://www.networksorcery.com/enp/rfc/rfc2003.txt">RFC 2003</a>, pages 1, 2 and 3:</p>
<blockquote>
<p>This document specifies a method by which an IP datagram may be encapsulated (carried as payload) within an IP datagram.
Encapsulation is suggested as a means to alter the normal IP routing for datagrams, by delivering them to an intermediate destination that
would otherwise not be selected based on the (network part of the) IP Destination Address field in the original IP header.
Once the encapsulated datagram arrives at this
intermediate destination node, it is decapsulated, yielding the original IP datagram,
which is then delivered to the destination indicated by the original Destination Address field.
This use of encapsulation and decapsulation of a datagram is frequently referred to
as &quot;tunneling&quot; the datagram, and the encapsulator and decapsulator are then considered to be the &quot;endpoints&quot; of the tunnel.</p>
  
<p>In the most general tunneling case we have:</p>

<p>source ---&gt; encapsulator --------&gt; decapsulator ---&gt; destination</p>

<p>with the source, encapsulator, decapsulator, and destination being separate nodes.
The encapsulator node is considered the &quot;entry point&quot; of the tunnel, and the
decapsulator node is considered the &quot;exit point&quot; of the tunnel.
There in general may be multiple source-destination pairs using the same tunnel between the encapsulator and decapsulator.</p>
</blockquote>

<blockquote>
<p>To encapsulate an IP datagram using IP in IP encapsulation, an outer IP header is inserted before the datagram's existing IP header.</p>
  
<p>The outer IP header Source Address and Destination Address identify the &quot;endpoints&quot; of the tunnel.
The inner IP header Source Address and Destination Addresses identify the original sender and recipient of the datagram, respectively.
The inner IP header is not changed by the encapsulator, except to decrement the TTL as noted
below, and remains unchanged during its delivery to the tunnel exit point.
No change to IP options in the inner header occurs during delivery of the encapsulated datagram through the tunnel.
If need be, other protocol headers such as the IP Authentication header
may be inserted between the outer IP header and the inner IP header.
Note that the security options of the inner IP header MAY affect the choice of security options for the encapsulating (outer) IP header.</p>
</blockquote>

<hr>

<table border="1">
<tr>
<td class="highlight">Outer <a href="ip.htm">IPv4</a> header</td>
<td class="highlight">Tunnel headers</td>
<td class="pkthdr">Inner <a href="ip.htm">IPv4</a> header</td>
<td class="pktvarlen">Data</td></tr>
</table>

<p><b>Inner IPv4 header:</b></p>

<table border="1">
<tr>
<th>00</th><th>01</th><th>02</th><th>03</th><th>04</th><th>05</th><th>06</th><th>07</th>
<th>08</th><th>09</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th>
<th>16</th><th>17</th><th>18</th><th>19</th><th>20</th><th>21</th><th>22</th><th>23</th>
<th>24</th><th>25</th><th>26</th><th>27</th><th>28</th><th>29</th><th>30</th><th>31</th></tr>
<tr>
<td class="pktconst" colspan="4">Version</td>
<td class="pkthdr" colspan="4">IHL</td>
<td class="pkthdr" colspan="8">TOS</td>
<td class="pkthdr" colspan="16">Total length</td></tr>
<tr>
<td class="pkthdr" colspan="16">Identification</td>
<td class="pkthdr" colspan="3">Flags</td>
<td class="pkthdr" colspan="13">Fragment offset</td></tr>
<tr>
<td class="pkthdr" colspan="8">TTL</td>
<td class="pkthdr" colspan="8">Protocol</td>
<td class="pkthdr" colspan="16">Header checksum</td></tr>
<tr>
<td class="pkthdr" colspan="32">Source IP address</td></tr>
<tr>
<td class="pkthdr" colspan="32">Destination IP address</td></tr>
<tr>
<td class="pktvarlen" colspan="32">Options and padding :::</td></tr>
</table>

<p><b>Version.</b>
4 bits.
Always set to 4.<br>
IPv4 version number.</p>

<p><b>IHL, Internet Header Length.</b>
4 bits.<br>
The length of the outer IP header measured in 32-bit words.</p>

<p><b>TOS, Type of Service.</b>
8 bits.<br>
The Type of Service (TOS) is copied from the inner IP header.</p>

<p>Optionally, another TOS may be used between cooperating peers.
This is in keeping with the transparency principle that if the user was expecting a given level of service, then
the tunnel should provide the same service.
However, some tunnels may be constructed specifically to provide a different level of service as a matter of policy.</p>

<p>TOS specifies the parameters for the type of service requested.
The parameters may be utilized by networks to define the handling of the datagram during transport.
The M bit was added to this field in <a href="/web/20210426065322/http://www.networksorcery.com/enp/rfc/rfc1349.txt">RFC 1349</a>.</p>

<table border="1">
<tr>
<th>00</th><th>01</th><th>02</th><th>03</th><th>04</th><th>05</th><th>06</th><th>07</th></tr>
<tr>
<td class="pkthdr" colspan="3">Precedence</td>
<td class="pkthdr" colspan="1">D</td>
<td class="pkthdr" colspan="1">T</td>
<td class="pkthdr" colspan="1">R</td>
<td class="pkthdr" colspan="1">M</td>
<td class="pktconst" colspan="1">0</td></tr>
</table>

<blockquote>
<p><b>Precedence.</b>
3 bits.</p>

<table class="datatbl" border="1" cellspacing="0">
<tr>
<th>Value</th><th>Description</th></tr>
<tr>
<th>0</th><td>Routine.</td></tr>
<tr>
<th>1</th><td>Priority.</td></tr>
<tr>
<th>2</th><td>Immediate.</td></tr>
<tr>
<th>3</th><td>Flash.</td></tr>
<tr>
<th>4</th><td>Flash override.</td></tr>
<tr>
<th>5</th><td>CRITIC/ECP.</td></tr>
<tr>
<th>6</th><td>Internetwork control.</td></tr>
<tr>
<th>7</th><td>Network control.</td></tr>
</table>

<p><b>D.</b>
1 bit.<br>
Minimize delay.</p>

<table class="datatbl" border="1" cellspacing="0">
<tr>
<th>Value</th><th>Description</th></tr>
<tr>
<th>0</th><td>Normal delay.</td></tr>
<tr>
<th>1</th><td>Low delay.</td></tr>
</table>
</blockquote>

<blockquote>
<p><b>T.</b>
1 bit.<br>
Maximize throughput.</p>

<table class="datatbl" border="1" cellspacing="0">
<tr>
<th>Value</th><th>Description</th></tr>
<tr>
<th>0</th><td>Normal throughput.</td></tr>
<tr>
<th>1</th><td>High throughput.</td></tr>
</table>
</blockquote>

<blockquote>
<p><b>R.</b>
1 bit.<br>
Maximize reliability.</p>

<table class="datatbl" border="1" cellspacing="0">
<tr>
<th>Value</th><th>Description</th></tr>
<tr>
<th>0</th><td>Normal reliability.</td></tr>
<tr>
<th>1</th><td>High reliability.</td></tr>
</table>
</blockquote>

<blockquote>
<p><b>M.</b>
1 bit.<br>
Minimize monetary cost.</p>

<table class="datatbl" border="1" cellspacing="0">
<tr>
<th>Value</th><th>Description</th></tr>
<tr>
<th>0</th><td>Normal monetary cost.</td></tr>
<tr>
<th>1</th><td>Minimize monetary cost.</td></tr>
</table>
</blockquote>

<p><b>Total Length.</b>
16 bits.<br>
The Total Length measures the length of the entire encapsulated IP datagram, including the outer IP header, the inner IP header, and its payload.</p>

<p><b>Identification.</b>
16 bits.<br>
A new number is generated for each outer IP header.</p>

<p>The encapsulated datagram may have already been fragmented, and another level of fragmentation may occur due to the tunnel encapsulation.
These tunnel fragments will be reassembled by the decapsulator, rather than the final destination.</p>

<p><b>Flags.</b>
3 bits.</p>

<table border="1">
<tr>
<th>00</th><th>01</th><th>02</th></tr>
<tr>
<td class="pkthdr">R</td>
<td class="pkthdr">DF</td>
<td class="pkthdr">MF</td></tr>
</table>

<blockquote>
<p><b>R, Reserved.</b>
1 bit.<br>
This bit is reserved and should be cleared to 0.
This unofficial flag has seen experimental use, and while it remains in the inner IP header, does not affect the tunnel.</p>
  
<p><b>DF, Don't fragment.</b>
1 bit.<br>
This bit controls the fragmentation of the datagram.
This is copied from the inner IP header.
This allows the originator to control the level of performance trade offs.</p>
  
<p>However, if the <i>DF</i> bit is set in the inner IP header, it MUST be set in the outer IP header; if the <i>DF</i> bit is not set in the
inner IP header, it MAY be set in the outer IP header.</p>

<table class="datatbl" border="1" cellspacing="0">
<tr>
<th>Value</th><th>Description</th></tr>
<tr>
<th>0</th><td>Fragment if necessary.</td></tr>
<tr>
<th>1</th><td>Do not fragment.</td></tr>
</table>

<p><b>MF, More fragments.</b>
1 bit.<br>
This is set as required when fragmenting.
The flag is not copied for the same reason that a separate Identification is used.</p>
  
<table class="datatbl" border="1" cellspacing="0">
<tr>
<th>Value</th><th>Description</th></tr>
<tr>
<th>0</th><td>This is the last fragment.</td></tr>
<tr>
<th>1</th><td>More fragments follow this fragment.</td></tr>
</table>
</blockquote>

<p><b>Fragment Offset.</b>
13 bits.<br>
Used to direct the reassembly of a fragmented datagram.</p>

<p><b>TTL, Time to Live.</b>
8 bits.<br>
The default value is specified in the most recent &quot;Assigned Numbers&quot;.
This ensures that long unanticipated tunnels do not interrupt the flow of datagrams between endpoints.</p>

<p>The inner Time To Live (TTL) field is decremented once before encapsulation, and is not affected by decapsulation.</p>

<p>The Time To Live (TTL) field in the outer IP header is set to a value appropriate for
delivery of the encapsulated datagram to the tunnel exit point.</p>

<p><b>Protocol.</b>
8 bits.<br>
Set to 4. The next header; 4 for the inner IP header, when no intervening tunnel headers are in use.</p>

<p><b>Header Checksum.</b>
16 bits.<br>
The IP checksum of the outer IP header.</p>

<p><b>Source Address.</b>
32 bits.<br>
The IP address of the encapsulator, that is, the tunnel entry point.</p>

<p><b>Destination Address.</b>
32 bits.<br>
The IP address of the decapsulator, that is, the tunnel exit point.</p>

<p><b>Options.</b>
Variable length.<br>
Any options present in the inner IP header are in general NOT copied to the outer IP header.
However, new options specific to the tunnel path MAY be added.
In particular, any supported types of security options of the inner IP header MAY affect the choice of security options for the outer header.
It is not expected that there be a one-to-one mapping of such options to the options or security headers selected for the tunnel.</p>

<p><b>Padding.</b>
Variable length.<br>
Used as a filler to guarantee that the data starts on a 32 bit boundary.</p>

<hr>

<p><b><a name="Glossary" href="/web/20210426065322/http://www.networksorcery.com/enp/glossary.htm">Glossary</a>:</b></p>

<hr>

<p><b><a name="RFCs" href="/web/20210426065322/http://www.networksorcery.com/enp/rfcs.htm">RFCs</a>:</b></p>

<p><b>[<a href="/web/20210426065322/http://www.networksorcery.com/enp/rfc/rfc1853.txt">RFC 1853</a>]</b>
IP in IP Tunneling.</p>
<ul>
<li>Category: Informational.</li>
</ul>

<p><b>[<a href="/web/20210426065322/http://www.networksorcery.com/enp/rfc/rfc2003.txt">RFC 2003</a>]</b>
IP Encapsulation within IP.</p>
<ul>
<li>Category: Standards Track.</li>
</ul>

<p><b>[<a href="/web/20210426065322/http://www.networksorcery.com/enp/rfc/rfc3884.txt">RFC 3884</a>]</b>
Use of IPsec Transport Mode for Dynamic Routing.</p>
<ul>
<li>Category: Informational.</li>
</ul>

<hr>

<p><b><a name="Publications" href="/web/20210426065322/http://www.networksorcery.com/enp/books.htm">Publications</a>:</b></p>

<table border="0">
<tr>
<td><iframe src="https://web.archive.org/web/20210426065322if_/http://rcm.amazon.com/e/cm?t=networksorcer-20&amp;o=1&amp;p=8&amp;l=as1&amp;asins=&amp;fc1=000000&amp;IS2=1<1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" name="I1"></iframe></td>
</tr>
</table>

<hr>

<p><b><a name="Obsolete RFCs" href="/web/20210426065322/http://www.networksorcery.com/enp/rfcs.htm">Obsolete RFCs</a>:</b></p>

<hr>

<table border="0" width="100%" bgcolor="white">
<tr>
<td>
<a href="https://web.archive.org/web/20210426065322/http://www.networksorcery.com/enp/" target="_parent"><img src="/web/20210426065322im_/http://www.networksorcery.com/enp/images/rfcsbutton.jpg" width="162" height="31"></a></td>
<td align="center" width="20%"><a href="#Description">Description</a></td>
<td align="center" width="20%"><a href="#Glossary">Glossary</a></td>
<td align="center" width="20%"><a href="#RFCs">RFCs</a></td>
<td align="center" width="20%"><a href="#Publications">Publications</a></td>
<td align="center" width="20%"><a href="#Obsolete RFCs">Obsolete RFCs</a></td></tr>
</table>

<hr>

<script type="text/javascript">copyrightnetworksorcery();</script>
<script type="text/javascript">analytics();</script>
<script type="text/javascript">pagetracker();</script>
</body>
</html>
<!--
     FILE ARCHIVED ON 06:53:22 Apr 26, 2021 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 18:15:10 Aug 15, 2022.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 84.137
  exclusion.robots: 0.309
  exclusion.robots.policy: 0.298
  cdx.remote: 0.095
  esindex: 0.012
  LoadShardBlock: 53.22 (3)
  PetaboxLoader3.datanode: 151.704 (5)
  CDXLines.iter: 19.135 (3)
  load_resource: 340.866 (2)
  PetaboxLoader3.resolve: 100.268 (2)
-->